This challenge involves exploiting the incorrect use of a random IV with CBC-MAC (i.e. by incorrectly using usual CBC). The theory behind the attack is [detailed on Wikipedia](https://en.wikipedia.org/wiki/CBC-MAC#Allowing_the_initialization_vector_to_vary_in_value) if my ramblings below are not good enough.

Basically, CBC works by computing `AES(PLAIN XOR IV, KEY)`. We are given the `PLAIN` plaintext and `IV` (second part of the signature). We want to produce a valid signature for the message `flagflagflagflag`.

The vulnerability is, that by choosing a random IV, we require the IV to be part of the input signature for verification. Therefore, the attacker can modify the IV. We have `AES(PLAIN XOR IV)`, so it would be great if we can have the same signature be reused for a different message. This is possible becuse we can construct message `M` and IV `IV'` such that `M XOR IV' == PLAIN XOR IV`. Then of course `AES(M XOR IV', KEY)` == `AES(PLAIN XOR IV, KEY)` so we have our "forged signature" (but rather a "forged IV" ;)).

```
IV' = PLAIN XOR IV XOR M
```

A sidenote, I find this pretty cool because for CBC encryption to be secure, you need a random IV, but for CBC MAC to be secure, you need a constant IV. This is not immediately obvious.
